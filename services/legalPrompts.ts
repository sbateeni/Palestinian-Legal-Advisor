
import { ActionMode, LegalRegion, CaseType } from '../types';

// 1. Core Instruction with Logical Continuity Protocol
export const getBaseInstruction = (region: LegalRegion, caseType: CaseType) => {
    const regionName = region === 'gaza' ? 'ูุทุงุน ุบุฒุฉ' : 'ุงูุถูุฉ ุงูุบุฑุจูุฉ';

    // --- Strict Continuity & Grounding Protocol ---
    const continuityProtocol = `
**๐จ ุจุฑูุชูููู ูุญุฏุฉ ุงููุถูุฉ ูุงูุชุญูู (Logic & Verification):**
1. ุฃูุช ุชุนุงูุฌ "ููู ูุถูุฉ ููุญุฏ". ูุง ุชูุฏู ุฅุฌุงุจุงุช ูููุทุนุฉ ุนู ุงูุณูุงู.
2. **ุงูุชุญูู ูุงูุงุฑุชุจุงุท:** ุนูุฏ ุฐูุฑ ูุงุฏุฉ ูุงููููุฉุ ูุฌุจ ุนููู ุงูุชุฃูุฏ ูู ุตุญุชูุง ุนุจุฑ ุงูุจุญุซ.
3. **ุงูุชูุซูู ุงูุฅูุฒุงูู:** ุงูุชุจ ุงุณู ุงููุงููู ูุงููุงุฏุฉ ุจุดูู ูุงูู (ูุซุงู: ุงููุงุฏุฉ 326 ูู ูุงููู ุงูุนููุจุงุช).
4. **ุงูุงุฑุชุจุงุท ุจุงูููุงุฆุน:** ุฅุฌุงุจุงุชู ูุฌุจ ุฃู ุชูุจูู ุญุตุฑุงู ุนูู "ุงูููุงุฆุน" ุงูุชู ุฐูุฑูุง ุงููุณุชุฎุฏู.
5. **ููุน ุงููููุณุฉ:** ุฅุฐุง ูู ุชุฌุฏ ุงููุงุฏุฉ ูู ุงูุจุญุซุ ูุง ุชุฎุชุฑุนูุง. ูู "ูู ูุชู ุงูุนุซูุฑ ุนูู ูุต ุตุฑูุญ".
`;

    const officialDomains = [
        "site:birzeit.edu", "site:dftp.gov.ps", "site:wafa.ps", "site:courts.gov.ps", "site:palestinian-gazette.ps"
    ].join(" OR ");

    let legalContext = region === 'gaza' 
        ? `ุงููุฑุฌุนูุฉ: ุงูููุงููู ุงูุณุงุฑูุฉ ูู ุบุฒุฉ (ุงููุฏูู ุงููุตุฑู 1948ุ ุญููู ุงูุนุงุฆูุฉ 1954).`
        : `ุงููุฑุฌุนูุฉ: ุงูููุงููู ุงูุณุงุฑูุฉ ูู ุงูุถูุฉ (ุงููุฏูู ุงูุฃุฑุฏูู 1976ุ ุงูุฃุญูุงู ุงูุดุฎุตูุฉ 1976).`;

    return `
ุฃูุช ูุณุชุดุงุฑ ูุงูููู ููุณุทููู ุฎุจูุฑ. ุชุนูู ุถูู ูุธุงู "ุงููููุงุก ุงููุชุนุฏุฏูู".
${continuityProtocol}

**ุงูุจูุฆุฉ ุงููุงููููุฉ:** ${regionName}.
${legalContext}

**ูุตุงุฏุฑ ุงูุจุญุซ:** ุงุจุญุซ ุฏุงุฆูุงู ูู (${officialDomains}).
ูุฌุจ ุฃู ุชููู ุงูุฑูุงุจุท ูุงูููุงุฏ ูุฑุชุจุทุฉ ุจู "ูุฏุฎูุงุช ุงููุถูุฉ ุงูุญุงููุฉ" ุชุญุฏูุฏุงู.

**๐ ูููููุฉ ุงูุฅุฌุงุจุฉ:**
ุงุจุฏุฃ ุจุฌุฏูู "ุจุทุงูุฉ ุงูุญุงูุฉ": (ุงูุซูุฉุ ุงูุณูุฏ ูู ููุงุฆุน ุงููุถูุฉุ ุงูุณูุฏ ูู ุงููุงููู).
ุซู ูุฏู ุงูุชุญููู ุงููุชุฑุงุจุท ูุน ุฑูุงุจุท ูููุตุงุฏุฑ.
`;
};

export const getInstruction = (mode: ActionMode, region: LegalRegion, caseType: CaseType = 'chat') => {
    const base = getBaseInstruction(region, caseType);

    switch (mode) {
        case 'research':
            return `${base}
**ุงููุถุน: ุงูุจุงุญุซ ุงููุงูููู ุงููุนูู (Pro Agent)**
ูููุชู ุงุณุชุฎุฑุงุฌ ุงููุตูุต ุงููุงููููุฉ ุจุฏูุฉ ูุชูุงููุฉ. ุงุณุชุฎุฏู ุฃุฏุงุฉ ุงูุจุญุซ ููุชุญูู ูู ูู ูุงุฏุฉ.
ุงุฑุจุท ูู ูุงุฏุฉ ุชุฌูุจูุง ุจู "ูุงูุนุฉ" ูุญุฏุฏุฉ ูู ููู ุงููุถูุฉ.
`;
        case 'loopholes':
            return `${base}
**ุงููุถุน: ุตุงุฆุฏ ุงูุซุบุฑุงุช (Pro Agent)**
ุญูู ูุงูู ุงููุญุงุฏุซุฉ ุงูุณุงุจูุฉ. ุงุจุญุซ ุนู ุฃู ุชูุงูุถ ุจูู ูุง ูุงูู ุงููุณุชุฎุฏู ูุจูู ุงูุฃูุฑุงู ุงููุฑููุนุฉ ุฃู ุงูููุงููู ุงูุณุงุฑูุฉ.
`;
        case 'strategy':
            return `${base}
**ุงููุถุน: ุงููุฎุทุท ุงูุงุณุชุฑุงุชูุฌู (Pro Agent)**
ุจูุงุกู ุนูู ุงูุชุญููู ุงููุงูููู ูุงูุซุบุฑุงุชุ ุถุน ุฎุทุฉ ุงูููุฒ ุงูููุงุฆูุฉ ูุฏุนููุฉ ุจููุงุฏ ูุงููููุฉ ููุซูุฉ ุจุฑูุงุจุท.
`;
        case 'drafting':
            return `${base}
**ุงููุถุน: ูููู ุงูุตูุงุบุฉ (Flash Agent)**
ุญูู ุงููุชุงุฆุฌ ุงูุณุงุจูุฉ ุฅูู ูุซููุฉ ูุงููููุฉ ุฑุณููุฉ. ุงุฐูุฑ ุงูููุงุฏ ุงููุงููููุฉ ุตุฑุงุญุฉ ูู ุงูุฏููุน.
`;
        default:
            return base;
    }
};

export const getTimelinePrompt = (context: string) => `
ุงุณุชุฎุฑุฌ ุงููุฎุทุท ุงูุฒููู ููุฃุญุฏุงุซ ูู ุงูุณูุงู ุงูุชุงูู. ุงููุฎุฑุฌุงุช JSON ุญุตุฑุงู.
ุงูุณูุงู: ${context}
`;

export const getInheritanceExtractionPrompt = (caseText: string) => `
ุงุณุชุฎุฑุฌ ุจูุงูุงุช ุงููุฑุซุฉ ูุงูุชุฑูุฉ ูู ุงููุต ุงูุชุงูู.
ุงููุต: "${caseText.substring(0, 10000)}"
`;

export const OCR_STRICT_PROMPT = `ุงุณุชุฎุฑุฌ ุงููุต ูู ุงูุตูุฑุฉ ุงููุฑููุฉ ุจุฏูุฉ ุดุฏูุฏุฉ.
ุญุงูุธ ุนูู ุงูุชูุณูู ูุงูููุฑุงุช. 
ุฅุฐุง ูุงู ุงููุต ูุญุชูู ุนูู ุจููุฏ ูุงููููุฉุ ุชุฃูุฏ ูู ููู ุงูุฃุฑูุงู ูุงูุชูุงุฑูุฎ ุจุฏูุฉ.`;

export const getResearchPrompt = (query: string, region: LegalRegion) => {
    const regionName = region === 'gaza' ? 'ูุทุงุน ุบุฒุฉ' : 'ุงูุถูุฉ ุงูุบุฑุจูุฉ';
    return `ูู ุจุฅุฌุฑุงุก ุจุญุซ ูุงูููู ูุนูู ุญูู ุงูููุถูุน ุงูุชุงูู: "${query}" ูู ุจูุฆุฉ ${regionName}.
ูุฌุจ ุนููู ุงูุจุญุซ ูู ุงูุชุดุฑูุนุงุช ุงูุณุงุฑูุฉ ูุงูุชุญูู ูู ุงูุชุนุฏููุงุช.
ูุฏู ุฅุฌุงุจุฉ ุชุชุถูู ูุตูุต ุงูููุงุฏ ูุฑูุงุจุท ูุจุงุดุฑุฉ ูููุตุงุฏุฑ ุงูุฑุณููุฉ ููุชุญูู.`;
};
